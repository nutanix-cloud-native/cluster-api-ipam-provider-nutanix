# Copyright 2024 Nutanix. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

apiVersion: v1
kind: Secret
metadata:
  name: pc-creds-for-ipam
stringData:
  credentials: |
    [
      {
        "type": "basic_auth",
        "data": {
          "prismCentral":{
            "username": "${NUTANIX_USER}",
            "password": "${NUTANIX_PASSWORD}"
          }
        }
      }
    ]
---
apiVersion: ipam.cluster.x-k8s.io/v1alpha1
kind: NutanixIPPool
metadata:
  name: nutanixippool-sample
spec:
  prismCentral:
    address: ${NUTANIX_ENDPOINT}
    port: 9440
    credentialsSecretRef:
      name: pc-creds-for-ipam
    additionalTrustBundle:
      trustBundleData: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZCVENDQXUyZ0F3SUJBZ0lRUzZoU2svZWFMNkp6Qmt1b0JJMTEwREFOQmdrcWhraUc5dzBCQVFzRkFEQlAKTVFzd0NRWURWUVFHRXdKVlV6RXBNQ2NHQTFVRUNoTWdTVzUwWlhKdVpYUWdVMlZqZFhKcGRIa2dVbVZ6WldGeQpZMmdnUjNKdmRYQXhGVEFUQmdOVkJBTVRERWxUVWtjZ1VtOXZkQ0JZTVRBZUZ3MHlOREF6TVRNd01EQXdNREJhCkZ3MHlOekF6TVRJeU16VTVOVGxhTURNeEN6QUpCZ05WQkFZVEFsVlRNUll3RkFZRFZRUUtFdzFNWlhRbmN5QkYKYm1OeWVYQjBNUXd3Q2dZRFZRUURFd05TTVRBd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFSwpBb0lCQVFEUFYrWG14RlFTN2JSSC9za25XSFpHVUNpTUhUNkkzd1dkMWJVWUtiM2R0VnEvK3ZiT283NnZBQ0ZMCllscGFQQUV2eFZnRDlvbi9qaEZENjhHMTRCUUhsbzl2SDlmbnVvRTVDWFZsdDhLdkdGczNKaWpuby9RSEsyMGEKLzZ0WXZKV3VRUC9weTFmRXRWdC9lQTBZWWJ3WDUxVEd1MG1Selc0WTBZQ0Y3cVpsTnJ4MDZyeFFUT3I4SWZNNApGcE9VdXJEVGF6Z0d6UllTZXNwU2RjaXRkckxDbkYyWVJWeHZZWHZHTGU0OEUxS0dBZGxYNWpnYzM0MjFINUtSCm11ZEtITXhGcUhKVjhMRG1vd2ZzL2FjYlpwNC9TSXR4aEhGWXlUcjY3MTd5VzBRclBIVG5qN0pId1FkcXpacTMKRFpiM0VvRW1VVlFLN0dIMjkvWGk4b3JJbFEyTkFnTUJBQUdqZ2Znd2dmVXdEZ1lEVlIwUEFRSC9CQVFEQWdHRwpNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01DQmdnckJnRUZCUWNEQVRBU0JnTlZIUk1CQWY4RUNEQUdBUUgvCkFnRUFNQjBHQTFVZERnUVdCQlM3dk1OSHBlUzhxY2JEcEhJTUVJMmlOZUhJNkRBZkJnTlZIU01FR0RBV2dCUjUKdEZubWU3Ymw1QUZ6Z0FpSXlCcFk5dW1iYmpBeUJnZ3JCZ0VGQlFjQkFRUW1NQ1F3SWdZSUt3WUJCUVVITUFLRwpGbWgwZEhBNkx5OTRNUzVwTG14bGJtTnlMbTl5Wnk4d0V3WURWUjBnQkF3d0NqQUlCZ1puZ1F3QkFnRXdKd1lEClZSMGZCQ0F3SGpBY29CcWdHSVlXYUhSMGNEb3ZMM2d4TG1NdWJHVnVZM0l1YjNKbkx6QU5CZ2txaGtpRzl3MEIKQVFzRkFBT0NBZ0VBa3JIblFUZnJlWjJCNXMzaUplRTZJT21RUkpXamdWelB3MTM5dmFCdzFiR1dLQ0lMMHZJbwp6d3puMU9aRGpDUWlIY0ZDa3RFSnI1OUw5TWh3VHlBV3NWcmRBZllmK0I5aGF4UW5zSEtOWTY3dTRzNUx6emZkCnU2UFV6ZWV0VUsyOXYrUHNQbUkyY0preHAraU4zZXBpNGhLdTlaelVQU3dNcXRDY2ViN3FQVnhFYnBZeFkxcDkKMW41UEpLQkxCWDllYjlMVTZsOHpTeFBXVjdiSzNsRzRYYU1KZ25UOXgzaWVzN21zRnRwS0s1YkR0b3Rpai9sMApHYUtlQTk3cGI1dXdEOUtnV3ZhRlhNSUV0OGpWVGpMRXZ3UmR2Q24yOTRHUERGMDhVOGxBa0l2N3RnaGx1YVFoCjFRbmxFNFNFTjRMT0VDajhkc0lHSlhwR1VrM2FVM0trSno5aWNLeSthVWdBKzJjUDIxdWg2TmNESVMzWHlmYVoKUWptRFE5OTNDaElJOFNYV3VwUVpWQmlJcGNXTzRScVprM2xyN0J6NU1VQ3d6RElBMzU5ZTU3U1NxNUNDa1kwTgo0QjZWdWxrN0xrdGZ3cmRHTlZJNUJzQzlxcXhTd1NLZ1JKZVo5d3lnSWFlaGJIRkhGaGNCYU1ES3BpWmxCSHl6CnJzbm5sRlhDYjVzOEhLbjVMc1VnR3ZCMjRMN3NHTlpQMkNYN2RoSG92K1loRCtqb3pMVzJwOVc0OTU5QnoyRWkKUm1xRHRtaVhMbnpxVHBYYkkrc3V5Q3NvaEtSZzZVbjBSQzQ3K2NwaVZ3SGlYWkFXK2NuOGVpTklqcWJWZ1hMeApLUHBkenZ2dFRuT1BsQzdTUVpTWW1kdW5yM0JmOWI3N0FpQy9aaWRzdEszNmRSSUxLejdPQTU0PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  subnet: ${NUTANIX_SUBNET_NAME}
  cluster: ${NUTANIX_PRISM_ELEMENT_CLUSTER_NAME}
---
apiVersion: ipam.cluster.x-k8s.io/v1beta1
kind: IPAddressClaim
metadata:
  name: my-ip
spec:
  poolRef:
    apiGroup: ipam.cluster.x-k8s.io
    kind: NutanixIPPool
    name: nutanixippool-sample
